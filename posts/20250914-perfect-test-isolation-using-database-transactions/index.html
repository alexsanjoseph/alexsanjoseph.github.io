<!DOCTYPE html>
<html lang="en">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.127.0">

    
    
    

<title>Perfect Test Isolation using Database Transactions • Alex&#39;s Blog</title>



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Perfect Test Isolation using Database Transactions">
  <meta name="twitter:description" content="Pasting random things together">
      <meta name="twitter:site" content="@alexsanjoseph">

<meta property="og:url" content="/posts/20250914-perfect-test-isolation-using-database-transactions/">
  <meta property="og:site_name" content="Alex&#39;s Blog">
  <meta property="og:title" content="Perfect Test Isolation using Database Transactions">
  <meta property="og:description" content="Pasting random things together">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-09-13T00:30:00-07:00">
    <meta property="article:modified_time" content="2025-09-14T10:51:29+05:30">
    <meta property="article:tag" content="Programming">
    <meta property="article:tag" content="Testing">
    <meta property="article:tag" content="Databases">
    <meta property="article:tag" content="Mvcc">


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/monokai.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.dd8a486d0ac22662cb396cf7748c114a226f8d8703763bf932cf2cfb7fabaff3.css" integrity="sha256-3YpIbQrCJmLLOWz3dIwRSiJvjYcDdjv5Ms8s&#43;3&#43;rr/M=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <link rel="stylesheet" href="/css/sidebar-toggle.css">
    <link rel="stylesheet" href="/css/site-home-link.css">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="icon" href="/icon.png">
    <link rel="shortcut icon" href="/icon.png">
    
    

    <script src="/js/sidebar-toggle.js"></script>
</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="/">Alex&#39;s Blog</a>
      </span>
      
        
        
        
        <div class="author-image">
          <img src="/images/alex.jpeg" alt="Author Image" class="img--circle img--headshot element--center">
        </div>
        
      
      
      <p class="site__description">
         Pasting random things together 
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Alex&#39;s Blog</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/portfolio/">
						<span>Portfolio</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/posts/">
						<span>Posts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/about/">
						<span>About</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/alexsanjoseph" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	<a href="https://github.com/alexsanjoseph" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/alexsanjoseph" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://stackoverflow.com/users/1653808/alex-joseph" rel="me"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
	<a href="mailto:alexsanjoseph%20at%20gmail.com" rel="me"><i class="fas fa-at fa-lg" aria-hidden="true"></i></a>
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2016 - 2025 alexsanjoseph
  
</div>


<div class="builtwith">
Built with <a href="https://gohugo.io">Hugo</a> ❤️ <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
</div>


  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <div class="home-button">
      <a href="/" class="home-link">← Home</a>
    </div>
    
    <div class="post-header-image">
      <img src="/images/perfect-test-isolation-using-database-transactions/cover.png" alt="Perfect Test Isolation using Database Transactions" class="header-image" />
    </div>
    
    <h1>Perfect Test Isolation using Database Transactions</h1>
    
    
<div class="post__meta">
    </script>
    
    
    <i class="fas fa-calendar-alt"></i> Created: 2025 Sep 13
    
    
    
    , Updated:
    2025 Sep 14
    
    
    
    
    
    
    
    <br />
     <i class="fas fa-tags"></i>
    
    <a class="badge badge-tag" href="/tags/programming">programming</a>
     
    
    <a class="badge badge-tag" href="/tags/testing">testing</a>
     
    
    <a class="badge badge-tag" href="/tags/databases">databases</a>
     
    
    <a class="badge badge-tag" href="/tags/mvcc">mvcc</a>
    
    
    
    
    <br />
    <i class="fas fa-clock"></i> 6 min read
</div>

  </header>
  
  
  <div class="post">
    <p>I believe that a hacker/script-kiddie evolves into a software engineer at the point when they realize that they need to write tests for their own benefit and not because someone else forced them to complete 100% test coverage in the code. That realization took me four years down the line after writing my first professional code, but that&rsquo;s a story for another day. Anything more than a pure exploratory script that I write will have some sort of automated testing associated with it today.</p>
<p>Today I want to take a break from all the AI craziness and spend a little bit of time explaining a small technique that works across any testing framework and any MVCC-capable database - using database transactions to achieve perfect test isolation without teardown boilerplate.</p>
<h2 id="using-data-in-tests">Using Data in Tests</h2>
<p>Any reasonably sized product and system will use a database to store/access data. At a really small scale, it can even be something as simple as SQLite/Files/Memory, but the moment you hit production, at any scale, you will want to use a real database.</p>
<p>Whether you&rsquo;re using pytest, unittest, Jest, RSpec, or any other testing framework, the pattern for database tests is always the same:</p>
<ul>
<li>Add data into the DB</li>
<li>Verify that the functionality works</li>
</ul>
<p>For example, let&rsquo;s say we have a User model in our application and want to test user permissions. Here&rsquo;s how it might look in Python with PostgreSQL (but the same concept applies to any language and database):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_user_permissions</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Create a user and role directly in the database (setup)</span>
</span></span><span style="display:flex;"><span>    conn <span style="color:#f92672">=</span> get_db_connection()
</span></span><span style="display:flex;"><span>    cursor <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span>cursor()
</span></span><span style="display:flex;"><span>    cursor<span style="color:#f92672">.</span>execute(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;INSERT INTO users (username, email) VALUES (</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">, </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">) RETURNING id&#34;</span>,
</span></span><span style="display:flex;"><span>        (<span style="color:#e6db74">&#34;testuser&#34;</span>, <span style="color:#e6db74">&#34;test@example.com&#34;</span>)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    user_id <span style="color:#f92672">=</span> cursor<span style="color:#f92672">.</span>fetchone()[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    cursor<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;INSERT INTO roles (name) VALUES (</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">) RETURNING id&#34;</span>, (<span style="color:#e6db74">&#34;admin&#34;</span>,))
</span></span><span style="display:flex;"><span>    role_id <span style="color:#f92672">=</span> cursor<span style="color:#f92672">.</span>fetchone()[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    cursor<span style="color:#f92672">.</span>execute(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;INSERT INTO user_roles (user_id, role_id) VALUES (</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">, </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">)&#34;</span>,
</span></span><span style="display:flex;"><span>        (user_id, role_id)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    conn<span style="color:#f92672">.</span>commit()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Test permission functionality</span>
</span></span><span style="display:flex;"><span>    has_admin <span style="color:#f92672">=</span> check_user_permission(user_id, <span style="color:#e6db74">&#34;admin_access&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> has_admin <span style="color:#f92672">==</span> <span style="color:#66d9ef">True</span>
</span></span></code></pre></div><p>The above setup works fine and if there are some issues with the application logic in <code>check_user_permission</code>, the test should find it correctly. However, the code above, as is, can cause insidious bugs regardless of which testing framework you&rsquo;re using.</p>
<h2 id="the-test-isolation-problem">The Test Isolation Problem</h2>
<p>The reason is that once there are multiple tests, they could secretly affect each other. If you create data in test A, it could still be hanging around when test B runs.
This causes flaky tests that pass sometimes and fail other times depending on the order they run in.
There is already lots of material available online on test isolation, so I am not going to go into that here.</p>
<p>The traditional solution to the problem is <code>setup</code> and <code>teardown</code>. Every testing framework has some version of this - pytest fixtures, unittest setUp/tearDown, Jest beforeEach/afterEach, etc. Before each test, you set up the data you need. After each test, you clean up everything you created.
In this example we are doing <code>setup</code> and <code>teardown</code> directly in the test function.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_user_permissions</span>():
</span></span><span style="display:flex;"><span>    conn <span style="color:#f92672">=</span> get_db_connection()
</span></span><span style="display:flex;"><span>    cursor <span style="color:#f92672">=</span> conn<span style="color:#f92672">.</span>cursor()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Setup - create test data</span>
</span></span><span style="display:flex;"><span>    cursor<span style="color:#f92672">.</span>execute(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;INSERT INTO users (username, email) VALUES (</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">, </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">) RETURNING id&#34;</span>,
</span></span><span style="display:flex;"><span>        (<span style="color:#e6db74">&#34;testuser&#34;</span>, <span style="color:#e6db74">&#34;test@example.com&#34;</span>)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    user_id <span style="color:#f92672">=</span> cursor<span style="color:#f92672">.</span>fetchone()[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    cursor<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;INSERT INTO roles (name) VALUES (</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">) RETURNING id&#34;</span>, (<span style="color:#e6db74">&#34;admin&#34;</span>,))
</span></span><span style="display:flex;"><span>    role_id <span style="color:#f92672">=</span> cursor<span style="color:#f92672">.</span>fetchone()[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    cursor<span style="color:#f92672">.</span>execute(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;INSERT INTO user_roles (user_id, role_id) VALUES (</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">, </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">)&#34;</span>,
</span></span><span style="display:flex;"><span>        (user_id, role_id)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    conn<span style="color:#f92672">.</span>commit()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Test - actual functionality we care about</span>
</span></span><span style="display:flex;"><span>    has_admin <span style="color:#f92672">=</span> check_user_permission(user_id, <span style="color:#e6db74">&#34;admin_access&#34;</span>)
</span></span><span style="display:flex;"><span>    has_super <span style="color:#f92672">=</span> check_user_permission(user_id, <span style="color:#e6db74">&#34;super_admin_access&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> has_admin <span style="color:#f92672">==</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> has_super <span style="color:#f92672">==</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Teardown - clean up everything we created</span>
</span></span><span style="display:flex;"><span>    cursor<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;DELETE FROM user_roles WHERE user_id = </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span>, (user_id,))
</span></span><span style="display:flex;"><span>    cursor<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;DELETE FROM users WHERE id = </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span>, (user_id,))
</span></span><span style="display:flex;"><span>    cursor<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;DELETE FROM roles WHERE id = </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span>, (role_id,))
</span></span><span style="display:flex;"><span>    conn<span style="color:#f92672">.</span>commit()
</span></span></code></pre></div><p>This seems to have fixed the problem to an extent, but now we have more issues.</p>
<ol>
<li>We now have a lot of boilerplate code which we don&rsquo;t care about.</li>
<li>Tests stopping in the middle for any reason (error in the code or even a power failure) can cause the data state to reach an invalid state, which can cause flakiness when running the test again.</li>
</ol>
<h2 id="mvcc">MVCC</h2>
<p>Many modern databases have this brilliant feature called Multi-Version Concurrency Control (MVCC). PostgreSQL, SQL Server, Oracle, and many others support it.
Without getting too deep into the database internals, it can be summarized as: MVCC databases can handle multiple versions of the same data simultaneously.</p>
<p>When you start a <em>transaction</em>, the database creates a snapshot of the data at that moment. Any changes you make within that transaction are only visible to you on that connection.
Other connections see the original data. If you rollback the transaction, it&rsquo;s like your changes never happened - the database just discards your version and keeps the original.
What is beautiful is that even if you don&rsquo;t manually rollback and the transaction gets cancelled for any reason, it is happening within a &ldquo;sandbox&rdquo; and other queries are not affected by these changes.</p>
<p>This is what makes MVCC databases so good at handling concurrent queries without locks everywhere. But it also gives us a superpower for testing.</p>
<h2 id="mvcc--tests">MVCC + Tests</h2>
<p>The idea is simple: what if we run each test inside its own transaction? Any data we create during the test automatically becomes invisible to other tests. We don&rsquo;t even need to worry about teardown!</p>
<p>We can update our code as:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># conftest.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pytest
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> psycopg2
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> Generator, Any
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@pytest.fixture</span>(scope<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;function&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">db_connection</span>() <span style="color:#f92672">-&gt;</span> Generator[Any, Any, <span style="color:#66d9ef">None</span>]:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Create a new connection for each test</span>
</span></span><span style="display:flex;"><span>    conn <span style="color:#f92672">=</span> psycopg2<span style="color:#f92672">.</span>connect(<span style="color:#e6db74">&#34;your_test_db_connection_string&#34;</span>)
</span></span><span style="display:flex;"><span>    conn<span style="color:#f92672">.</span>autocommit <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>  <span style="color:#75715e"># Start transaction</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">yield</span> conn
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">finally</span>:
</span></span><span style="display:flex;"><span>        conn<span style="color:#f92672">.</span>rollback()
</span></span><span style="display:flex;"><span>        conn<span style="color:#f92672">.</span>close()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># test_something.py</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_user_permissions</span>(db_connection):
</span></span><span style="display:flex;"><span>    cursor <span style="color:#f92672">=</span> db_connection<span style="color:#f92672">.</span>cursor()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Create test data - same as before but now within transaction</span>
</span></span><span style="display:flex;"><span>    cursor<span style="color:#f92672">.</span>execute(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;INSERT INTO users (username, email) VALUES (</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">, </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">) RETURNING id&#34;</span>,
</span></span><span style="display:flex;"><span>        (<span style="color:#e6db74">&#34;testuser&#34;</span>, <span style="color:#e6db74">&#34;test@example.com&#34;</span>)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    user_id <span style="color:#f92672">=</span> cursor<span style="color:#f92672">.</span>fetchone()[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    cursor<span style="color:#f92672">.</span>execute(<span style="color:#e6db74">&#34;INSERT INTO roles (name) VALUES (</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">) RETURNING id&#34;</span>, (<span style="color:#e6db74">&#34;admin&#34;</span>,))
</span></span><span style="display:flex;"><span>    role_id <span style="color:#f92672">=</span> cursor<span style="color:#f92672">.</span>fetchone()[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    cursor<span style="color:#f92672">.</span>execute(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;INSERT INTO user_roles (user_id, role_id) VALUES (</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">, </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">)&#34;</span>,
</span></span><span style="display:flex;"><span>        (user_id, role_id)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Test permission functionality - same as before</span>
</span></span><span style="display:flex;"><span>    has_admin <span style="color:#f92672">=</span> check_user_permission(user_id, <span style="color:#e6db74">&#34;admin_access&#34;</span>)
</span></span><span style="display:flex;"><span>    has_super <span style="color:#f92672">=</span> check_user_permission(user_id, <span style="color:#e6db74">&#34;super_admin_access&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> has_admin <span style="color:#f92672">==</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> has_super <span style="color:#f92672">==</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># No teardown needed! MVCC handles isolation automatically</span>
</span></span></code></pre></div><p>This seems like a very small change, but the benefits can add up quickly since we are no longer worried about test isolation.
The connection object is best managed at the framework level (pytest&rsquo;s <code>conftest.py</code>, Jest&rsquo;s setup files, etc.) with appropriate scoping and shared by all tests.
This pattern has saved me countless hours of writing teardown code and hunting down flaky tests.</p>
<p>One thing to note is that this works great for database logic, but if your tests interact with external services or run E2E tests or files, you&rsquo;ll still need traditional teardown for those.
For the vast majority of backend tests this shouldn&rsquo;t be a problem since you&rsquo;re mostly testing application logic and using the DB to store/retrieve data.</p>
<p>Give it a try in your next project, regardless of which testing framework you&rsquo;re using, and let me know how it goes!</p>
<blockquote class="info">
    <strong>You can use the same MVCC concepts within an API to keep it idempotent as well as handle failures cleanly! I&rsquo;ll explain this in another post.</strong><br>
    
</blockquote>
<hr>
<p><em>Thanks to <a href="https://github.com/acrarshin">acrarshin</a> and <a href="https://github.com/RainingComputers">RainingComputers</a> for giving pointers to improve this post!</em></p>
<p><em>If you found this useful, please consider upvoting it on <a href="https://news.ycombinator.com/item?id=45265007">Hacker News</a>!</em></p>
  </div>
  


  

  
    
        <div id="graphcomment"></div>
<script type="text/javascript">
  window.graphcomment_id = 'blog-alexsanjoseph-com';
   
  (function() {
    var gc = document.createElement('script'); gc.type = 'text/javascript'; gc.async = true;
    gc.src = 'https://graphcomment.com/js/integration.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(gc);
  })();
</script>
    


</article>

        </div>
        
    

<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/all.js"
    integrity="sha384-b3ua1l97aVGAPEIe48b4TC60WUQbQaGi2jqAWM90y0OZXZeyaTCWtBTKtjW2GXG1"
    crossorigin="anonymous"></script>
<script data-goatcounter="https://alexsanjoseph.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
<script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
     inlineMath: [['$','$'], ['\\(','\\)']],
     displayMath: [['$$','$$']],
     processEscapes: true,
     processEnvironments: true,
     skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
     TeX: { equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>
<script>
    
    
    
    window.goatcounter.visit_count({ append: 'body' })
</script>

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    



    



    </body>
</html>
